"use strict";(()=>{var e={};e.id=873,e.ids=[873],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},14300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},12781:e=>{e.exports=require("stream")},73837:e=>{e.exports=require("util")},33277:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>h,patchFetch:()=>w,requestAsyncStorage:()=>c,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>d});var a={};t.r(a),t.d(a,{POST:()=>l});var s=t(49303),o=t(88716),i=t(60670),n=t(87070),u=t(95456);async function l(e){try{let{email:r,password:t}=await e.json();if(!r||!t)return n.NextResponse.json({error:"Email and password are required"},{status:400});let a=await u.e.login(r,t),s=u.e.generateToken(a);return n.NextResponse.json({success:!0,user:a,token:s})}catch(e){return console.error("Login error:",e),n.NextResponse.json({error:e instanceof Error?e.message:"Login failed"},{status:401})}}let p=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/auth/login/route",pathname:"/api/auth/login",filename:"route",bundlePath:"app/api/auth/login/route"},resolvedPagePath:"C:\\Users\\win11\\Desktop\\newequa1\\src\\app\\api\\auth\\login\\route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:m}=p,h="/api/auth/login/route";function w(){return(0,i.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:d})}},95456:(e,r,t)=>{t.d(r,{e:()=>l});var a=t(42023),s=t.n(a),o=t(41482),i=t.n(o);let n=new Map,u=process.env.JWT_SECRET||"your-super-secret-jwt-key-change-in-production";class l{static async register(e,r,t){if(!e||!r||!t)throw Error("Email, password, and name are required");if(r.length<8)throw Error("Password must be at least 8 characters long");if(n.has(e.toLowerCase()))throw Error("User with this email already exists");let a=await s().hash(r,12),o={id:crypto.randomUUID(),email:e.toLowerCase(),name:t.trim(),passwordHash:a,createdAt:new Date};return n.set(o.email,o),{email:o.email,name:o.name}}static async login(e,r){if(!e||!r)throw Error("Email and password are required");let t=n.get(e.toLowerCase());if(!t||!await s().compare(r,t.passwordHash))throw Error("Invalid email or password");return{email:t.email,name:t.name}}static generateToken(e){return i().sign({email:e.email,name:e.name,iat:Math.floor(Date.now()/1e3)},u,{expiresIn:"7d"})}static verifyToken(e){try{let r=i().verify(e,u);return{email:r.email,name:r.name}}catch(e){return null}}static async hashPassword(e){return s().hash(e,12)}static async verifyPassword(e,r){return s().compare(e,r)}static getUserByEmail(e){return n.get(e.toLowerCase())}static async updatePassword(e,r){let t=n.get(e.toLowerCase());if(!t)throw Error("User not found");let a=await this.hashPassword(r);t.passwordHash=a,n.set(t.email,t)}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[948,972,944],()=>t(33277));module.exports=a})();